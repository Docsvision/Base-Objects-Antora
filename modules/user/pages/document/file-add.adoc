= Добавление файла в карточку

.Файл можно добавить в карточку следующими способами:
* xref:document/new-document.adoc#from-wincl[При создании] карточки "Документ".
* С помощью перетаскивания <<filesystem,из файловой системы>>.
* Путем xref:document/file-scan.adoc#simple[простого сканирования] файла.
* Путем сканирования файла xref:document/file-scan.adoc#recognition[с распознаванием].
* С помощью перетаскивания из приложения <<outlook,Microsoft Outlook>>.
* С использованием <<context,контекстного меню>> области вложений карточки Документ.
* С помощью перетаскивания приложенного файла <<other-card,из другой карточки>>.
* <<clipboard,Из буфера обмена>> Windows.

Также специалистами по внедрению системы могут быть настроены дополнительные способы добавления файлов в _Справочнике видов карточек_.

.Могут быть добавлены следующие способы добавления файлов:
* Автоматическое создание файла по шаблону при создании карточки.
* Карточки могут по умолчанию создаваться с основным и/или дополнительным файлами.
* При создании карточки может автоматически выдаваться запрос на добавление основного файла со сканера или с файловой системы.

[#filesystem]
== Добавить файл перетаскиванием из файловой системы

Методом перетаскивания в карточку можно добавить как _основной_, так и _дополнительный_ файл.

.Чтобы добавить файл в карточку при помощи перетаскивания из файловой системы:
. Перетащите файл из _Проводника_ на xref:document/card.adoc#attachments[Область вложений] карточки _Документ_.
+
* В область _Основные файлы_, чтобы добавить файл как _основной_.
* В область _Дополнительные файлы_, чтобы добавить файл как _дополнительный_.

Название файла будет отображено в xref:document/card.adoc#attachments["Области вложений"].

[#context]
== Добавить файл командой контекстного меню из файловой системы

Командами контекстного меню в карточку можно добавить как _основной_, так и _дополнительный_ файл.

.Чтобы добавить файл в карточку при помощи команды контекстного меню:
. Откройте карточку _Документ_.
. Если файлов в карточке нет, в xref:document/card.adoc#attachments["Области вложений"] правой клавишей мыши вызовите контекстное меню, затем выберите требуемую команду:
+
* menu:Добавить файл из файловой системы[Основной], чтобы добавить файл как _основной_.
* menu:Добавить файл из файловой системы[Дополнительный], чтобы добавить файл как _дополнительный_.
+
.Контекстное меню для добавления файла из файловой системы
image::document-add-from-system-context.png[Контекстное меню для добавления файла из файловой системы]
+
Название файла будет отображено в _Области вложений_.
+
. Если файлы уже добавлены в карточку, перед вызовом контекстного меню установите курсор в _Области вложений_ на области _основных_ или _дополнительных_ файлов (в зависимости от того, как будет использоваться файл). Затем вызовите контекстное меню и выберите команду _Добавить файл из файловой системы_.
+
Файл будет добавлен в ту область, откуда было вызвано контекстное меню.

[#outlook]
== Добавить файл перетаскиванием из MS Outlook

Файл может быть добавлен в карточку _Документ_ перетаскиванием из открытого письма и из области просмотра приложения _Microsoft Outlook_. Добавить можно как письмо, так и вложенный файл.

Поддерживается и обратное действие: при перетаскивании файлов из карточки в окно _Microsoft Outlook_ создается письмо с соответствующим вложением. В поле _Тема_ копируется название файла, а в поле вложений копируется файл.

.Чтобы перетащить письмо из MS Outlook:
. Откройте карточку _Документ_.
. Перетащите письмо в xref:document/card.adoc#attachments[Область вложений].
+
Письмо будет приложено к карточке в виде файла с расширением `.msg`. Файл, вложенный в письмо, будет добавлен в том же формате, что и в письме.

[#other-card]
== Добавить файл перетаскиванием из другой карточки "Документ"

Файл может быть добавлен в карточку _Документ_ перетаскиванием из другой карточки.

. Откройте две карточки _Документ_, исходную и целевую.
. Перетащите файл из _Области вложений_ исходной карточки в _Область вложений_ целевой карточки.
+
Если в целевой карточке нет ни одного добавленного файла, перетаскиваемый файл по умолчанию будет добавлен как основной. Если в карточке уже хранятся ранее приложенные файлы, при перетаскивании новых файлов появится диалог для выбора типа добавляемых файлов.
+
. Выберите тип добавляемого файла, затем нажмите на кнопку *Принять*.
+
.Выбор типа файла для добавления
image::document-select-file-type.png[Выбор типа файла для добавления]
+
Файл будет добавлен в соответствующую часть _Области вложений_.

[#clipboard]
== Добавить файл из буфера обмена

Файл, скопированный в буфер обмена Windows, можно добавить в карточку с помощью команды контекстного меню или сочетания клавиш. Данным способом можно добавить один или сразу несколько основных или дополнительных файлов.

.Чтобы добавить скопированный в буфера обмена файл в карточку:
. Откройте карточку _Документ_.
. Если файлов в карточке нет, вызовите контекстное меню правой клавишей мыши в xref:document/card.adoc#attachments["Области вложений"], затем выберите команду _Вставить_.
+
.Контекстное меню для добавления файла из буфера обмена
image::document-file-clipboard.png[Контекстное меню для добавления файла из буфера обмена]
+
Файлы будут добавлены как основные. Название файлов будет отображено в _Области вложений_.
+
* Если в буфере обмена нет файлов или их добавление запрещено ролевой моделью, команда _Вставить_ будет отключена.
* Если операция добавления отключена в автомате состояний, то указанная команда контекстного меню будет скрыта.
+
. Если в карточке уже есть основные файлы (дополнительных файлов нет), после вызова команды _Вставить_ выберите тип добавляемого файла: *Основной* или *Дополнительный*.
+
.Выбор типа файла для добавления
image::document-select-file-type.png[Выбор типа файла для добавления]
+
Все файлы из буфера обмена будут добавлены в область, соответствующую выбранному типу файла.
+
. Если в карточке есть основные и дополнительные файлы, перед вызовом контекстного меню установите курсор в _Области вложений_ на _основных_ или _дополнительных_ файлах (в зависимости от того, как будет использоваться файл). Затем вызовите контекстное меню и выберите команду _Вставить_.
+
Файлы будут добавлены в ту область, откуда было вызвано контекстное меню.
+
[NOTE]
====
Вместо команды _Вставить_ можно использовать стандартное сочетание клавиш kbd:[Ctrl + V] или kbd:[Shift + Ins]. Перед этим кликните по _Области вложений_, чтобы фокус перешел к ней (при этом данная область графически не выделяется).

Ограничения на добавление файлов данным способом аналогичны ограничениям на добавление файлов с помощью команды _Вставить_.

Используя сочетание клавиш kbd:[Ctrl + C] или kbd:[Ctrl + Ins] можно скопировать выделенный в _Области вложений_ файл в буфер обмена.
====
