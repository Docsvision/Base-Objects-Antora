= Настройки модуля в справочнике "Системные настройки"

.Справочник _Системные настройки_ содержит следующие настройки модуля {bo}:
* Настройки функции подписания и шифрования карточек.
* Настройки поведения {wc}а при открытии файлов, доступных только для чтения.

[#system-settings]
== Запуск справочника "Системные настройки"

. Откройте {wincl} от имени администратора {dv}.
. В дереве папок откройте раздел menu:Конструкторы и справочники[Системные настройки].
+
.Справочник "Системные настройки"
image::sys-settings.png[Справочник "Системные настройки"]

[#sections]
== Разделы справочника "Системные настройки"

// TODO -- подписи!!

[#signature-cypher]
=== Раздел "Подписи и шифрование"

.Раздел "Подписи и шифрование"
image::sign-cypher.png[Раздел "Подписи и шифрование"]

Электронные подписи позволяют установить факт модификации информации и получить гарантию её подлинности, а также подтвердить авторство внесенных в документы изменений.

В системе {dv} могут применяться все возможные виды подписей, определяемые по Федеральному закону N 63-ФЗ "Об электронной подписи".

include::desdirs:partial$excerpts.adoc[tags=signatures]

Использование простой подписи доступно пользователям без дополнительной настройки. Для использования усиленной подписи (квалифицированной или неквалифицированной) администратор {dv} должен <<settings,настроить>> параметры подписания.

Состав подписи (набор атрибутов, включаемых в подпись) определяется настройками вида карточек в "Справочнике видов карточек" и не зависит от вида используемой подписи.

[#settings]
.Чтобы настроить параметры шифрования и подписи файлов через справочник:
. В области _Категории_ выберите раздел menu:{bo}[Подписи и шифрование], чтобы открыть настройки _Подписей и шифрования_.
+
.Настройки подписи и шифрования базовых объектов
image::signature-encryption.png[Настройки подписи и шифрования базовых объектов]
+
. В поле _Провайдер_ выберите названия провайдера для шифрования и подписи файлов.
+
****
Система {dv} интегрируется с любыми системами КЗИ (крипто-провайдерами), поддерживающими интерфейс Microsoft Crypto API. Выяснить, поддерживает ли конкретная система КЗИ интерфейс Crypto API, можно у её производителя.

.Примерами систем, поддерживающих Crypto API, являются:
* https://www.cryptopro.ru/cryptopro/products/csp/default.htm[КриптоПро CSP].
* https://www.signal-com.ru/products/crypt/signal-com-csp/[Signal-COM CSP].

[WARNING]
====
Компоненты системы КЗИ должны быть установлены на всех клиентских рабочих местах, иначе возможность работы с предоставляемыми СКЗИ функциями (подписания, проверка подписи и др.) будет невозможна.

К примеру, проверка подписи, установленной с использованием криптопровайдера КриптоПро, будет невозможна на рабочих местах, на которых не установлен КриптоПро CSP.
====

Поддержка Crypto API -- необходимое, но не достаточное условие для возможности интеграции криптопровайдера с {dv}, так как в реализации каждого провайдера могут быть свои нюансы (особенности реализации методов), препятствующие их совместной корректной работе.

Каждый конкретный провайдер должен предварительно быть проверен на совместимость с {dv}. Эту проверку можно выполнить самостоятельно или обратиться к любому партнеру {dv}.

{dv} _гарантирует_ корректную работу со стандартными крипто-провайдерами Microsoft, входящими в состав операционной системы Windows, а также поддержку аутентификации и ЭП смарт-карт eToken (фирмы-производителя Аладдин Р.Д.)
****
+
[lowerroman]
.Чтобы выбрать провайдера:
.. Нажмите на кнопку image:buttons/threedots.png[Три точки].
+
В окне _Выбор провайдера шифрования_ отображается дерево, узловыми элементами которого являются _типы_, а ветками -- _названия_ провайдеров.
+
.Выбор провайдера шифрования
image::crypto-provider.png[Выбор провайдера шифрования]
+
.. Выберите провайдера, затем нажмите на кнопку *ОК*.
+
. Выберите необходимый _Алгоритм шифрования_ из раскрывающегося списка в поле. Алгоритм будет использован для проведения операции шифрования файлов.
+
Предлагаемый список алгоритмов зависит от выбранного ранее провайдера.
+
. В поле _Длина ключа_ выбирается необходимая длина ключа для шифрования.
+
Длина ключа должна выбираться в зависимости от используемой в организации операционной системы.
+
.Выбрать можно один из следующих вариантов:
* *_По умолчанию_* -- длина ключа определяется по умолчанию.
* *_Минимальная_* и *_Максимальная_* длина ключа зависит от выбранного алгоритма шифрования.
* *_Пользовательская_* -- длина ключа задаётся в зависимости от выбранного алгоритма шифрования, число символов должно быть кратным `8`.
+
Пользовательская длина ключа задаётся в диапазоне от *_Минимальной_* до *_Максимальной_*.
+
. Выберите из раскрывающегося списка необходимый _Алгоритм подписи_.
+
Список доступных алгоритмов подписи зависит от выбранного провайдера.
+
. Чтобы использовать усовершенствованную подпись со штампом времени ({long}), настройте параметры подключения к серверу службы выдачи штампов времени.
+
****
:provider: TSP провайдер
:service: штампов времени
:api: ITspService
include::partial$excerpts.adoc[tags=provider]
xref:programmer:BackOffice-ObjectModel-Services-ITaskService:ITspService_IN.adoc[Руководстве разработчика].
****
+
В поле _Адрес TSP сервиса_ укажите путь к сервису службы штампов времени. Наличие адреса определяет, что будет сформирована усовершенствованная ({long}) подпись.
+
* Указывайте _Адрес TSP сервиса_, если должна формироваться усовершенствованная подпись ({long}).
* Не указывайте _Адрес TSP сервиса_ для обычной усиленной ({bes}) подписи.
+
Для использования потребуется лицензия на TSP-клиент.
+
****
:provider: OCSP провайдер
:service: актуальных статусов сертификатов
:api: IOcspService
include::partial$excerpts.adoc[tags=provider]
xref:programmer:BackOffice-ObjectModel-Services-INumerationRulesService:IOcspService_IN.adoc[Руководстве разработчика].

Укажите OCSP провайдер, если используется усовершенствованная подпись ({long}).
****
+
// Указывать адрес OCSP сервиса (службы актуальных статусов сертификатов) не требуется.
+
[WARNING]
====
Для формирования подписей формата {long} (усовершенствованная подпись) необходимо указать TSP и OCSP провайдеров, а также указать адрес TSP сервиса.

Если формирование усовершенствованных подписей не требуется, достаточно указать адрес TSP провайдера.
====
+
. В поле _Файлы для шифрования_ при помощи флагов определите тип файлов, для которого может выполняться шифрование:
+
* `*Основные*` -- будет выполняться шифрование только основных файлов, вложенных в карточку.
* `*Дополнительные*` -- будет выполняться шифрование дополнительных файлов, вложенных в карточку.
+
. При необходимости установите флаг `*Проверять действительность сертификата, используя внешние списки отзыва сертификатов*`.
+
В процессе проверки подписи будет также проверена действительность сертификата согласно спискам отзыва, если установлен данный флаг, а в использованном сертификате указаны пути к спискам отзыва (CRL), публикуемым удостоверяющим центром.
+
Если проверка даст отрицательный результат, то подпись будет верна только математически. То есть будет удостоверено, что содержание документа не изменялось и соответствует подписи, но при этом сертификат подписи недействителен (отозван, или истек срок его действия).
+
. Чтобы выявить, успешно ли работают заданные параметры подписи и шифрования, нажмите на кнопку *Проверить*.

[#cards]
=== Раздел "Карточки"

Раздел _Карточки_ содержит единственную настройку, которая определяет необходимость отображать оповещение при открытии из карточки файла, доступного только на чтение.

Если из карточек открываются приложенные файлы, на которые отсутствуют права доступа, или когда файлы заблокированы другими пользователями, система {dv} по умолчанию выдает предупреждение: `Файл будет открыт в режиме только для чтения. Следующие операции запрещены: Редактирование основного файла`. Появление подобных сообщений можно отключить сразу для всех пользователей системы.

.Чтобы отключить предупреждения:
. В области _Категории_ выберите раздел menu:{bo}[Карточки].
. Установите флаг `*Не показывать предупреждение об открытии файлов только для чтения*`.
+
.Настройки открытия файлов карточек базовых объектов
image::file-open-settings.png[Настройки открытия файлов карточек базовых объектов]
+
Файл будет открыт в режиме чтения, без появления каких-либо предупреждений.
+
. Чтобы вернуться к режиму показа уведомлений, снимите флаг.

[#mail-client]
== Раздел "Почтовый клиент &#62; Настройки администратора"

Раздел menu:Почтовый клиент[Настройки администратора] содержит общие настройки маршрутизации заданий в почту.

.Настройки администратора
image::admin-settings.png[Настройки администратора]

.Данная страница содержит следующие поля:
* _E-mail адрес администратора_ -- почтовый адрес администратора модуля для отправки сообщений об ошибках в работе модуля, вызванных прерыванием связи с почтовым сервером;
* _E-mail адрес сервера_ -- адрес электронной почты для отправки писем о действиях с заданием;
* _Формат ссылки для {wc}а_ -- шаблон для формирования ссылки для открытия карточек задания в {wc}е;
* _Формат ссылки для {wincl}а_ -- шаблон для формирования ссылки для открытия карточек задания в {wincl}е.
